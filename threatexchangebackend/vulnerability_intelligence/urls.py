from rest_framework import routers
from .views import CveViewSet, cve_detail
from django.urls import path

router = routers.SimpleRouter(trailing_slash=False)

# api.add_resource(CweListResource, "/cwe")
# api.add_resource(CweResource, "/cwe/<string:id>")
# api.add_resource(CweCveResource, "/cwe/<string:id>/cve")
# api.add_resource(CveListResource, "/cve")
# api.add_resource(CveResource, "/cve/<string:id>")
# api.add_resource(ReportListResource, "/reports")
# api.add_resource(SubscriptionListRessourceVendor, "/account/subscriptions/vendors")
# api.add_resource(SubscriptionListRessourceProduct, "/account/subscriptions/products")
# api.add_resource(ReportResource, "/reports/<string:link>")
# api.add_resource(AlertListResource, "/reports/<string:link>/alerts")
# api.add_resource(AlertResource, "/reports/<string:link>/alerts/<string:id>")
# api.add_resource(VendorListResource, "/vendors")
# api.add_resource(VendorResource, "/vendors/<string:name>")
# api.add_resource(VendorCveResource, "/vendors/<string:name>/cve")
# api.add_resource(ProductListResource, "/vendors/<string:vendor>/products")
# api.add_resource(ProductResource, "/vendors/<string:vendor>/products/<string:product>")
# api.add_resource(
#     ProductCveResource, "/vendors/<string:vendor>/products/<string:product>/cve"
# )

router.register(r'cve', CveViewSet)

urlpatterns = router.urls

urlpatterns += [
    path('cve/<cve_id>', cve_detail, name = 'cvedetails')
]